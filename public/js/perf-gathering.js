"use strict";function _slicedToArray(e,n){return _arrayWithHoles(e)||_iterableToArrayLimit(e,n)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,n){var t=[],r=!0,a=!1,o=void 0;try{for(var i,d=e[Symbol.iterator]();!(r=(i=d.next()).done)&&(t.push(i.value),!n||t.length!==n);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==d.return||d.return()}finally{if(a)throw o}}return t}function _arrayWithHoles(e){if(Array.isArray(e))return e}!function(a){var n=a.performance||{},o=n.navigation,t=a.appVars||{},e=a.TTCOM_Scripts||{};e.perfGathering={};var i=n.timing,r=e.splunk,d=e.PromiseHandler,c=e.perfBeaconTools,s=a.analyticsUtility,m=t.perfLogging.browserResourcesSamplingPercentage,u=null,g={domInteractiveInMilliseconds:0,domCompleteInMilliseconds:0,perceivedLoadTimeInMicroseconds:0},l={divideDurationBy1000AndRoundTwoDecimals:function(e){return(e/1e3).toFixed(2)},getDifferenceBetweenTimestampsInSeconds:function(e,n){var t=n-e;return l.divideDurationBy1000AndRoundTwoDecimals(t)},getKeyValuePairsStringFromObject:function(e){var a=[];return Object.entries(e).forEach(function(e){var n=_slicedToArray(e,2),t=n[0],r=n[1];a.push("".concat(t,"=").concat(r))}),a.join("&")},getExperienceName:function(){var e="",n=document.querySelector("[data-com-type='page']");return t.pageview&&t.pageview.contentIdentifier&&(e=t.pageview.contentIdentifier),n&&n.dataset.autoSel&&(e&&(e+="|"),e+=n.dataset.autoSel),e},getRandomNumberUnder100:function(){return Math.floor(100*Math.random())+1},thisDataShouldBeTracked:function(e){e=e||{};var n=Object.assign({samplingPercentage:0,enabled:!1},e);if(!1===n.enabled||0===Number(n.samplingPercentage))return!1;if(100===Number(n.samplingPercentage))return!0;if(a.localStorage){var t=a.localStorage.getItem("includeInPerfSampling");if("true"===t)return!0;if("false"===t)return!1}var r=l.getRandomNumberUnder100()<=n.samplingPercentage;try{a.localStorage.setItem("includeInPerfSampling",r)}catch(e){}return r}},p={filterDataByNameAndFiletype:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.location.origin;return e.filter(function(e){return 0===e.name.indexOf(n)&&0<=e.name.indexOf(t.perfLogging.browserResourcesFileTypeFilter)})},gatherRefinedData:function(){var e=n.getEntries("resource");return p.filterDataByNameAndFiletype(e).map(function(e){var n=e.duration,t=e.responseEnd;return{name:e.name,duration:n,responseEnd:t,startTime:e.startTime,transferSize:e.transferSize,nextHopProtocol:e.nextHopProtocol}})},samplingPercentageIsNotaNumber:function(){return m&&isNaN(m)},shouldBeCollected:function(){if(!n.getEntries)return!1;if(!t.perfLogging.browserResourcesEnabled||0===m)return!1;if(p.samplingPercentageIsNotaNumber())throw new Error("appVars.perfLogging.browserResourcesSamplingPercentage = ".concat(m," and is expected to be a number"));return 100===m||l.getRandomNumberUnder100()<=m},handleResourceData:function(){if(p.shouldBeCollected()&&r){var e=p.gatherRefinedData();r.logMessage({prettyMessage:"performance resource data gathered",errorMessage:JSON.stringify(e),url:"/api/v1/cse/jsError",logKey:"clientSideBrowserResourceData",logValue:l.getExperienceName(),cookieIds:"tms,s_vi"})}}},f=function(){var e,n,t,r=function(e){var n=Object.assign({},e);for(var t in e)e.hasOwnProperty(t)&&(e[t]<=0||isNaN(e[t]))&&delete n[t];return n}((e=i,n=g.perceivedLoadTimeInMicroSeconds,t=l.divideDurationBy1000AndRoundTwoDecimals(n),{navigationStart2loadEventEnd:l.getDifferenceBetweenTimestampsInSeconds(e.navigationStart,e.loadEventEnd),navigationStart2connectEnd:l.getDifferenceBetweenTimestampsInSeconds(e.navigationStart,e.connectEnd),requestStart2responseEnd:l.getDifferenceBetweenTimestampsInSeconds(e.requestStart,e.responseEnd),domLoading2domComplete:l.getDifferenceBetweenTimestampsInSeconds(e.domLoading,e.domComplete),domLoading2domContentLoaded:l.getDifferenceBetweenTimestampsInSeconds(e.domLoading,e.domContentLoaded),loadEventStart2loadEventEnd:l.getDifferenceBetweenTimestampsInSeconds(e.loadEventStart,e.loadEventEnd),navigationStart2domInteractive:l.getDifferenceBetweenTimestampsInSeconds(e.navigationStart,e.domInteractive),navigationStart2perceivedLoadTime:t,connectEnd2domContentLoaded:l.getDifferenceBetweenTimestampsInSeconds(e.connectEnd,e.domContentLoadedEventStart),navigationStart2domContentLoaded:l.getDifferenceBetweenTimestampsInSeconds(e.navigationStart,e.domContentLoadedEventStart),navigationStart2domComplete:l.getDifferenceBetweenTimestampsInSeconds(e.navigationStart,e.domComplete),redirectStart2redirectEnd:l.getDifferenceBetweenTimestampsInSeconds(e.redirectStart,e.redirectEnd),fetchStart2domainLookupStart:l.getDifferenceBetweenTimestampsInSeconds(e.fetchStart,e.domainLookupStart),domainLookupStart2domainLookupEnd:l.getDifferenceBetweenTimestampsInSeconds(e.domainLookupStart,e.domainLookupEnd),connectStart2connectEnd:l.getDifferenceBetweenTimestampsInSeconds(e.connectStart,e.connectEnd),requestStart2responseStart:l.getDifferenceBetweenTimestampsInSeconds(e.requestStart,e.responseStart),unloadEventStart2unloadEventEnd:l.getDifferenceBetweenTimestampsInSeconds(e.unloadEventStart,e.unloadEventEnd),domContentLoadedEventStart2domContentLoadedEventEnd:l.getDifferenceBetweenTimestampsInSeconds(e.domContentLoadedEventStart,e.domContentLoadedEventEnd),domLoading2domInteractive:l.getDifferenceBetweenTimestampsInSeconds(e.domLoading,e.domInteractive)}));return r.navigationType=o.type,r.navigationRedirectCount=o.redirectCount,r.experience=l.getExperienceName(),Object.assign(r,{appCodeName:a.navigator.appCodeName,appName:a.navigator.appName,appVersion:a.navigator.appVersion,concurrentHardware:a.navigator.hardwareConcurrency,oscpu:a.navigator.oscpu,platform:a.navigator.platform,productSub:a.navigator.productSub,userAgent:a.navigator.userAgent,vendor:a.navigator.vendor,vendorSub:a.navigator.vendorSub}),{prettyMessage:"performance data gathered",url:"/api/v1/cse/jsError",logKey:"clientSidePerformanceData",logValue:"data&"+l.getKeyValuePairsStringFromObject(r),cookieIds:"tms,s_vi"}},v=function(){r&&r.logMessage(f())},S=function(){var e="performance|domInteractive";return g.perceivedLoadTimeInMicroSeconds&&(e+="|perceivedLoadTime"),e},E=function(){var e="".concat(g.domInteractiveInMilliseconds);return g.perceivedLoadTimeInMicroSeconds&&(e+="|".concat(g.perceivedLoadTimeInMicroSeconds)),e},I=function(){if(s){g.domInteractiveInMilliseconds=i.domInteractive-i.navigationStart;var e=S(),n=E();s.triggerEvent("page-perf-event",[{key:"REM",value:n},{key:"EVENT_TYPE",value:e}])}},T=function(){s&&s.triggerEvent("page-perf-event",[{key:"REM",value:i.domComplete-i.navigationStart},{key:"EVENT_TYPE",value:"performance|domComplete"}])};c&&i&&(d&&window.Promise?(u=new d,document.addEventListener("DOMContentLoaded",function(){u.registerCriteria(c.getCriteria()),u.evaluateCriteria().then(function(){1<=u.countCriteria()&&(g.perceivedLoadTimeInMicroSeconds=n.now()),I()})}),window.addEventListener("load",function(){l.thisDataShouldBeTracked(t.perfLogging)&&!Object.is(i,{})&&(setTimeout(v,1e3),T()),p.handleResourceData()})):(document.addEventListener("DOMContentLoaded",function(){I()}),document.addEventListener("load",function(){T(),p.handleResourceData()})),e.perfGathering.getBeaconDurationName=S,e.perfGathering.getBeaconDurationValue=E)}(window);